<div class="d-flex ps-5 pe-5 align-items-end justify-content-between">
  <div class="d-flex align-items-end gap-3">
    <p class="h2">Tareas</p>
    <app-input-tarea></app-input-tarea>
  </div>
  <div class="d-flex input-group w-25 border border-secondary rounded">
      <span class="input-group-text bg-secondary text-white" id="basic-addon1">Filtrar por:</span>
    <select class="form-control" (change)="filtrarTareas($event)">
      <option value="all">Todas las tareas</option>
      <option value="descanso">Tareas de descanso</option>
      <option value="trabajo">Tareas de trabajo</option>
    </select>
  </div>
</div>
<hr class="ms-4 me-4 border border-secondary" />
<div class="container col-sm-11 ms-5 me-5 mb-5">
  @if(tareas$ | async; as tareas){
  <div class="row">
    @for (item of tareasLista; track item.id){
      @if (filtro === 'all'){
        <div class="bg-light rounded-4 border border-secondary mt-3 p-3">
          <div class="d-flex justify-content-between align-items-center">
            @if(item.descanso){
            <div class="d-flex align-items-center">
              <div class="d-flex flex-column gap-1">
                <span class="label label-info">Descanso</span>
                <span class="label label-primary">{{item.init}}-{{item.ended}}</span> 
              </div>
              <p class="card-text h4 ms-3 mt-0">{{ item.descripcion }}</p>
            </div>
            
            }
            @else {
              <div class="d-flex align-items-center">
                <div class="d-flex flex-column">
                  <span class="label label-warning">Trabajando</span>
                  <span class="label label-primary">{{item.init}}-{{item.ended}}</span> 
                </div>
                <p class="card-text h4 ms-3 mt-0">{{ item.descripcion }}</p>
              </div>
            }
            <div class="d-flex gap-3">
              <button class="btn btn-primary" (click)="editarTarea(item)" data-bs-toggle="modal"
                data-bs-target="#editarTarea">Editar</button>
              <button class="btn btn-danger" (click)="eliminarTarea(item)">Eliminar</button>
            </div>
          </div>
        </div> 
      } 
      @if (filtro==='descanso') {
        @if (item.descanso) {
          <div class="bg-light rounded-4 border border-secondary mt-3 p-3">
            <div class="d-flex justify-content-between align-items-center">
              @if(item.descanso){
              <div class="d-flex align-items-center">
                <div class="d-flex flex-column gap-1">
                  <span class="label label-info">Descanso</span>
                  <span class="label label-primary">{{item.init}}-{{item.ended}}</span> 
                </div>
                <p class="card-text h4 ms-3 mt-0">{{ item.descripcion }}</p>
              </div>
              
              }
              @else {
                <div class="d-flex align-items-center">
                  <div class="d-flex flex-column">
                    <span class="label label-warning">Trabajando</span>
                    <span class="label label-primary">{{item.init}}-{{item.ended}}</span> 
                  </div>
                  <p class="card-text h4 ms-3 mt-0">{{ item.descripcion }}</p>
                </div>
              }
              <div class="d-flex gap-3">
                <button class="btn btn-primary" (click)="editarTarea(item)" data-bs-toggle="modal"
                  data-bs-target="#editarTarea">Editar</button>
                <button class="btn btn-danger" (click)="eliminarTarea(item)">Eliminar</button>
              </div>
            </div>
          </div> 
        }@else {}
      }
      @if (filtro==='trabajo') {
        @if (!item.descanso) {
          <div class="bg-light rounded-4 border border-secondary mt-3 p-3">
            <div class="d-flex justify-content-between align-items-center">
              @if(item.descanso){
              <div class="d-flex align-items-center">
                <div class="d-flex flex-column gap-1">
                  <span class="label label-info">Descanso</span>
                  <span class="label label-primary">{{item.init}}-{{item.ended}}</span> 
                </div>
                <p class="card-text h4 ms-3 mt-0">{{ item.descripcion }}</p>
              </div>
              
              }
              @else {
                <div class="d-flex align-items-center">
                  <div class="d-flex flex-column">
                    <span class="label label-warning">Trabajando</span>
                    <span class="label label-primary">{{item.init}}-{{item.ended}}</span> 
                  </div>
                  <p class="card-text h4 ms-3 mt-0">{{ item.descripcion }}</p>
                </div>
              }
              <div class="d-flex gap-3">
                <button class="btn btn-primary" (click)="editarTarea(item)" data-bs-toggle="modal"
                  data-bs-target="#editarTarea">Editar</button>
                <button class="btn btn-danger" (click)="eliminarTarea(item)">Eliminar</button>
              </div>
            </div>
          </div> 
        }@else {}
      }
    }
  </div>
  }@else {
  <h1 class="m-5">No hay Tareas</h1>

  }
</div>
<!-- Modal -->
<div class="modal fade" id="editarTarea" tabindex="-1" aria-labelledby="editarTareaLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg text-start">
    <div class="modal-content">
      
      <div class="modal-header d-flex">
        <div class="d-flex align-items-center ps-4 pe-3">
          <p class="modal-title fs-4 fw-bold">Actualizar Tarea</p>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
      </div>
      
      <div class="modal-body ps-5 pe-5">
        <form>
          <div class="mb-3 d-flex justify-content-between">
            <div class="mb-3 d-flex gap-2 align-items-end">
              <p for="init" class="form-label">Hora Inicio:</p>
              <input type="text" class="form-control w-50"  placeholder="00:00" id="init" value="{{tarea.init}}" (keyup)="actualizarInit($event)">
            </div>
            <div class="mb-3 d-flex gap-2 align-items-end">
              <p for="ended" class="form-label">Hora Fin:</p>
              <input type="text" class="form-control w-50"  placeholder="00:00" id="ended" value="{{tarea.ended}}"
                (keyup)="actualizarEnded($event)">
            </div>
            <div class="form-check d-flex align-items-center">
              <label class="form-check-label">
                <input type="checkbox" class="form-check-input" id="descanso" [checked]="tarea.descanso"
                (click)="actualizarDescanso($event)">
                Descanso
                <span class="form-check-sign"></span>
              </label>
             </div>
          </div>
          <div class="mb-3">
            <label for="descripcion" class="form-label">Descripcion:</label>
            <input type="text" class="form-control" id="descripcion" placeholder="Tarea" value="{{tarea.descripcion}}"
              (keyup)="actualizarDescripcion($event)">
          </div>
        </form>
      </div>
      <div class="modal-footer pe-5 pt-3 pb-3">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        <button type="button" class="btn btn-primary" (click)="actualizarTarea()">Actualizar</button>
      </div>
    </div>
  </div>
</div>